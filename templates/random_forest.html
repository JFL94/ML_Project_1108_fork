{% extends "base.html" %}

{% block head %}
{{ super() }}
<title>隨機森林 - 離職預測</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/prediction.css') }}">
{% endblock %}

{% block content %}
<div class="page-header">
    <h1>隨機森林 (Random Forest)</h1>
    <p>調整下方的壓力特徵滑桿，即時預測員工的離職傾向機率。</p>
</div>

<div class="prediction-wrapper">

    <div class="controls-panel card-style">
        <h2 class="panel-title">壓力特徵控制器</h2>

        <div class="slider-group">
            <label for="feature1">
                <span>工作量壓力</span>
                <span class="slider-value" id="feature1-value">3</span>
            </label>
            <input type="range" id="feature1" class="slider" min="1" max="5" value="3" step="1">
        </div>

        <div class="slider-group">
            <label for="feature2">
                <span>組織風氣-申訴管道壓力</span>
                <span class="slider-value" id="feature2-value">3</span>
            </label>
            <input type="range" id="feature2" class="slider" min="1" max="5" value="3" step="1">
        </div>
    </div>

    <div class="results-panel card-style">
        <h2 class="panel-title">即時預測結果</h2>

        <div class="percentage-display">
            <span id="risk-percentage">...%</span>
            <p>離職傾向機率</p>
        </div>

        <div class="progress-bar-container">
            <div id="risk-progress" class="progress-bar-fill"></div>
        </div>

        <div class="risk-interpretation">
            <h3 id="risk-label">計算中...</h3>
            <p id="risk-interpretation">請拖動滑桿以查看分析</p>
        </div>
    </div>
</div>

<div class="chart-container card-style">
    <h2>特徵分佈散佈圖 (200筆隨機樣本)</h2>
    <div class="chart-canvas-wrapper">
        <canvas id="scatterChart"></canvas>
    </div>
    <div class="chart-legend">
        <span class="legend-item legend-no">■ 未離職</span>
        <span class="legend-item legend-yes">■ 離職</span>
    </div>
</div>

<div class="info-blocks-wrapper">
    <div class="info-card card-style">
        <h3>模型評估指標 (測試集)</h3>
        <ul>
            <li><strong>召回率 (Recall):</strong> 0.80 (範例)</li>
            <li><strong>F1-Score:</strong> 0.78 (範例)</li>
            <li><strong>AUC 分數:</strong> 0.92 (範例)</li>
        </ul>
    </div>

    <div class="info-card card-style">
        <h3>模型資訊</h3>
        <ul>
            <li><strong>資料集:</strong> 北北桃地區員工壓力調查</li>
            <li><strong>總樣本數:</strong> 1500 (範例)</li>
            <li><strong>訓練集大小:</strong> 1200 (範例)</li>
            <li><strong>測試集大小:</strong> 300 (範例)</li>
            <li><strong>預測目標:</strong> 離職傾向 (turnover_intention)</li>
        </ul>
    </div>

    <div class="info-card card-style">
        <h3>圖表說明</h3>
        <p>
            此散佈圖展示了「工作量壓力」(X軸) 與「組織風氣壓力」(Y軸) 之間的關係。
            每個點代表一個隨機抽樣的員工：
            <span class="legend-no">藍點</span>代表無離職傾向，
            <span class="legend-yes">紅點</span>代表有離職傾向。
            您可以觀察兩類群體在壓力特徵上的分佈差異。
        </p>
    </div>
</div>

{% endblock %}

{% block code %}
<script src="{{ url_for('static', filename='vendor/chart.js/chart.umd.js') }}"></script>
<script src="{{ url_for('static', filename='js/random_forest.js') }}"></script>
{% endblock%}